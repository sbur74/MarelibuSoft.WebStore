function sendDeleteCart(){var n=$("#cartid").html(),t=$("#sessionid").html(),i=$("input[name='__RequestVerificationToken']").val(),r="api/ShoppingCarts/"+n;$.ajax(r,{type:"DELETE",headers:i,data:JSON.stringify({iD:n,sessionId:t}),success:function(){$("#cartDisplay").load("/AjaxContent/ShoppingCart")},"async":!1,contentType:"application/json",dataType:"json",timeout:6e4})}if(!marelibusoft)var marelibusoft={};marelibusoft.shop||(marelibusoft.shop={});marelibusoft.shop.lastPriceChangeVariantId=0;marelibusoft.shop.checkOption=function(n,t){var r=$("#variantSelect_"+n),u=marelibusoft.common.str2Float(r.find(":selected").attr("data-option-quantity")),i=marelibusoft.common.str2Float(r.find(":selected").attr("data-option-price")),f,e,o;u>0&&$("#variantQuantity_"+n).html(u);marelibusoft.shop.lastPriceChangeVariantId==n&&($("#optionPrice").empty(),$("#optionPrice").remove(),$("#"+t+"_quantityPrice").html($("#grundPreis").html()));i>0&&(marelibusoft.shop.lastPriceChangeVariantId=n,f=marelibusoft.common.str2Float($("#grundPreis").html()),$("#optionPrice").empty(),$("#optionPrice").remove(),$("#optionPriceTableBody").append("<tr id='optionPrice'><td> + <\/td><td>"+marelibusoft.common.float2LocalCurrencyString(i)+"<\/td><\/tr>"),e=f+i,o=marelibusoft.common.float2LocalCurrencyString(e),$("#"+t+"_quantityPrice").html(o))};marelibusoft.shop.sendCartLine=function(n,t,i){var w=$("#cartid").html(),b=$("input[name='__RequestVerificationToken']").val(),e=n,k=marelibusoft.common.str2Float(i),d=$("#"+e+"_sellActionItemId").val(),a=marelibusoft.common.str2Float($("#"+e+"_quantity").val()),v=$("#textOptionInput"),u={shoppingCartID:w,quantity:a,productID:e,unitID:t,sellBasePrice:k,sellActionItemId:d,shoppingCartLineTextOptions:[],variantValues:[]},o,s,h,p,c,r,l;if(v.length>0){if(!marelibusoft.shop.checkTextVariant())return;o=v.val();txtOption={text:o};u.shoppingCartLineTextOptions.push(txtOption);u.textVariant=o}if(s=$("#variants"),s)for(h=s.find("select"),r=0;r<h.length;r++){var g=h[r].getAttribute("id"),f=$("#"+g),nt=f.attr("data-variant-id"),tt=f.find(":selected").attr("data-option-price"),y=f.find(":selected").attr("data-option-id"),it=f.find(":selected").val();y&&(p={productVariant:nt,productVariantOption:y,price:tt,value:it,quantity:a},u.variantValues.push(p))}for(c=!1,r=0;r<u.variantValues.length;r++)l=u.variantValues[r],c=marelibusoft.shop.checkAvailableQuantity(l.productVariantOption,l.quantity);c&&$.ajax("/api/ShoppingCartLines/variant",{type:"POST",headers:{"X-XSRF-TOKEN":b},data:JSON.stringify(u),success:function(n){console.log(n);getAvailableQuantity(n);$("#cartDisplay").load("/AjaxContent/ShoppingCart");marelibusoft.common.showModalAlert("alert","Erfolgreich angelegt!","success")},error:function(){$("#cartDisplay").load("/AjaxContent/ShoppingCart");marelibusoft.common.showModalAlert("alert","Bei der Anlage ist ein Fehler aufgetreten!","danger");setTimeout(location.reload(),800)},contentType:"application/json",timeout:6e4})};marelibusoft.shop.checkAvailableQuantity=function(n,t){var i=$("#optionId_"+n).data("option-quantity"),r;return(i=marelibusoft.common.str2Float(i),r=$("#description").data("base-unit"),t>i)?(marelibusoft.common.showModalAlert(n,"Menge nicht verfügbar! Maximal "+i+" "+r+" verfügbar!","danger"),!1):!0};marelibusoft.shop.checkTextVariant=function(){var r=$("#textOptionInput"),i,n,t;if(r.length>0){if(i=r.val(),i.length==0)return marelibusoft.shop.showTextInputError(),!1;if(n=i.split(" "),n.length>1){for(t=0;t<n.length;t++)if(n[t].length>0)return marelibusoft.shop.hideTextInputError(),!0;return marelibusoft.shop.showTextInputError(),!1}return marelibusoft.shop.hideTextInputError(),!0}};marelibusoft.shop.showTextInputError=function(){marelibusoft.common.showModalAlert("textOptionInput","Sie müssen einen Text eingeben!","danger");$("#textVariantValidate").append("Sie müssen einen Text eingeben!");$("#textOptionInput").addClass("danger")};marelibusoft.shop.hideTextInputError=function(){$("#textVariantValidate").hide();$("#textOptionInput").removeClass("danger")};marelibusoft.shop.countText=function(){var n=$("#textOptionInput").val();if(n.length>16){marelibusoft.common.showModalAlert("myalert","Sie können nicht mehr als 16 Zeichen verwenden!","warning");$("#textOptionInput").val(n.substr(0,n.length-1));return}};